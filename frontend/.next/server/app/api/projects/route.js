"use strict";(()=>{var e={};e.id=871,e.ids=[871],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},63477:e=>{e.exports=require("querystring")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},62450:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>w,originalPathname:()=>k,patchFetch:()=>j,requestAsyncStorage:()=>z,routeModule:()=>b,serverHooks:()=>h,staticGenerationAsyncStorage:()=>x,staticGenerationBailout:()=>I});var n={};t.r(n),t.d(n,{GET:()=>v,POST:()=>m,runtime:()=>d});var o=t(6170),i=t(8533),a=t(54387),s=t(37504),l=t(90236),c=t(50033),u=t(40999),p=t(50268);function g(){if(!process.env.DATABASE_URL)throw Error("DATABASE_URL is not defined");return(0,l.qn)(process.env.DATABASE_URL)}let d="nodejs";async function v(){try{let e=g(),r=await e`
            SELECT 
                id,
                name,
                status,
                "overviewText",
                description,
                "overviewImage1",
                "overviewImage2",
                "overviewImage3",
                link,
                "gitHubLink",
                "isActive"
            FROM "Project" 
            ORDER BY id ASC
        `;if(!r||0===r.length)return s.NextResponse.json({projects:[]});let t=r.map(e=>{let r=c.PH.safeParse(e);return r.success?r.data:(console.warn("Project validation failed:",r.error),null)}).filter(e=>null!==e);return s.NextResponse.json({projects:t})}catch(e){return console.error("Error fetching projects:",e),s.NextResponse.json({error:"Failed to fetch projects"},{status:500})}}async function m(e){if(!await (0,u.getServerSession)(p.L))return new s.NextResponse("Unauthorized",{status:401});try{let r=g(),t=await e.json(),n=await r`
            INSERT INTO "Project" (name, status, "overviewText", description, "overviewImage1", "overviewImage2", "overviewImage3", link, "gitHubLink", "isActive")
            VALUES (${t.name}, ${t.status}, ${t.overviewText}, ${t.description}, ${t.overviewImage1}, ${t.overviewImage2}, ${t.overviewImage3}, ${t.link}, ${t.gitHubLink}, ${t.isActive??!0})
            RETURNING id, name, status, "overviewText", description, "overviewImage1", "overviewImage2", "overviewImage3", link, "gitHubLink", "isActive"
        `;return s.NextResponse.json(n)}catch(e){return console.error("Error creating project:",e),e instanceof Error&&(console.error("Error name:",e.name),console.error("Error message:",e.message),console.error("Error stack:",e.stack)),s.NextResponse.json({error:"Failed to create project"},{status:500})}}let b=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/projects/route",pathname:"/api/projects",filename:"route",bundlePath:"app/api/projects/route"},resolvedPagePath:"C:\\Users\\henry\\cursourProjects\\ofolio\\frontend\\app\\api\\projects\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:z,staticGenerationAsyncStorage:x,serverHooks:h,headerHooks:w,staticGenerationBailout:I}=b,k="/api/projects/route";function j(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:x})}},50268:(e,r,t)=>{t.d(r,{L:()=>i});var n=t(68152);let o=(e,r)=>{let t=e.replace(/\/$/,"");return`${t}/api/auth/callback/${r}`};console.log("Vercel callback URL:",o(process.env.NEXTAUTH_URL_INTERNAL,"github-vercel")),console.log("Personal callback URL:",o(process.env.NEXTAUTH_URL,"github-personal"));let i={providers:[(0,n.Z)({id:"github-vercel",clientId:process.env.GITHUB_ID,clientSecret:process.env.GITHUB_SECRET,authorization:{params:{redirect_uri:o(process.env.NEXTAUTH_URL_INTERNAL,"github-vercel")}}}),(0,n.Z)({id:"github-personal",clientId:process.env.GITHUB_ID_PERSONAL,clientSecret:process.env.GITHUB_SECRET_PERSONAL,authorization:{params:{redirect_uri:o(process.env.NEXTAUTH_URL,"github-personal")}}})],callbacks:{async signIn({user:e,account:r}){if(console.log("Sign in attempt with provider:",r?.provider),console.log("Callback URL:",r?.redirect_uri),r?.provider==="github-vercel"||r?.provider==="github-personal"){let e=await fetch("https://api.github.com/user",{headers:{Authorization:`token ${r.access_token}`}}),t=await e.json();return(process.env.ALLOWED_GITHUB_USERS?.split(",")||[]).map(e=>e.trim()).includes(t.login)}return!1},jwt:async({token:e,user:r,account:t})=>(r&&(e.role="admin"),e),session:async({session:e,token:r})=>(e?.user&&(e.user.role=r.role),e)},pages:{signIn:"/auth/signin"},debug:!1,cookies:{sessionToken:{name:"__Secure-next-auth.session-token",options:{httpOnly:!0,sameSite:"lax",path:"/",secure:!0}}}}},50033:(e,r,t)=>{t.d(r,{IA:()=>s,PH:()=>i,Zd:()=>l,lD:()=>u,wr:()=>c});var n=t(78024);let o=n.z.enum(["InProgress","CompleteMaintained","CompleteUnmaintained","Planned"]),i=n.z.object({id:n.z.number().int().positive(),name:n.z.string().min(1).max(100),status:o,overviewText:n.z.string().max(3e3).nullable(),description:n.z.string().max(5e3).nullable(),overviewImage1:n.z.string().nullable(),overviewImage2:n.z.string().nullable(),overviewImage3:n.z.string().nullable(),link:n.z.string().nullable(),gitHubLink:n.z.string().nullable(),isActive:n.z.boolean().default(!0)});n.z.string().regex(/^\d+$/).transform(Number);let a=n.z.enum(["low","med","high"]),s=n.z.object({id:n.z.number().int().positive(),enableBackground:n.z.boolean(),enableChatbot:n.z.boolean(),enableContactForm:n.z.boolean(),activeBackgroundPackId:n.z.string().nullable(),backgroundConfig:n.z.record(n.z.string(),n.z.unknown()),backgroundQuality:a,reducedMotionOverride:n.z.boolean().nullable(),siteTitle:n.z.string(),tagline:n.z.string(),aboutContent:n.z.string(),avatarImageUrl:n.z.string().nullable(),logoImageUrl:n.z.string().nullable()}),l=s.omit({id:!0}).partial(),c=n.z.object({id:n.z.string(),name:n.z.string(),version:n.z.string(),entryUrl:n.z.string(),manifestUrl:n.z.string(),previewUrl:n.z.string().nullable(),interactive:n.z.boolean(),allowExternal:n.z.boolean(),manifest:n.z.unknown(),uploadedBlobUrls:n.z.array(n.z.string()),createdAt:n.z.coerce.date(),updatedAt:n.z.coerce.date()}),u=n.z.object({name:n.z.string().min(1),version:n.z.string().min(1),entry:n.z.string().min(1).default("index.html"),interactive:n.z.boolean().optional().default(!1),allowExternal:n.z.boolean().optional().default(!1),controls:n.z.array(n.z.object({key:n.z.string().min(1),type:n.z.enum(["toggle","number","select","text","color"]).optional(),label:n.z.string().min(1),default:n.z.unknown().optional(),min:n.z.number().optional(),max:n.z.number().optional(),step:n.z.number().optional(),options:n.z.array(n.z.string()).optional(),help:n.z.string().optional()})).optional().default([])})}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[499,823,24,299,236],()=>t(62450));module.exports=n})();